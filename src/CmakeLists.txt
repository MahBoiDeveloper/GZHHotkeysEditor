project(GZHHotkeysEditor)

# project sources
file(
    GLOB SOURCES
    LIST_DIRECTORIES false
    RELATIVE ${CMAKE_CURRENT_SOURCE_DIR}
    ${CMAKE_CURRENT_SOURCE_DIR}/*.cpp
)
# project headers
file(
    GLOB HEADERS
    LIST_DIRECTORIES false
    RELATIVE ${CMAKE_CURRENT_SOURCE_DIR}
    ${CMAKE_CURRENT_SOURCE_DIR}/*.hpp
)

# main target
add_executable(GZHHotkeysEditor
    ${SOURCES}
    ${HEADERS}
)
set_target_properties(GZHHotkeysEditor
    PROPERTIES
    CXX_STANDART 17
    CXX_STANDART_REQUIRED ON
)
# link gui subproject
subdirs(gui)
target_link_libraries(GZHHotkeysEditor PRIVATE
    Gui
)

#---------------Qt libs deploy-----------------
set(CMAKE_PREFIX_PATH "C:/Qt/5.15.2/mingw81_64")
# set(QT_PLUGIN_PATH "${CMAKE_PREFIX_PATH}/plugins/platforms")
if(CMAKE_BUILD_TYPE STREQUAL "Release")
    if(WIN32)
        add_custom_command(
            TARGET GZHHotkeysEditor POST_BUILD
            COMMAND "${CMAKE_PREFIX_PATH}/bin/windeployqt.exe"
                # --release
                # --no-compiler-runtime
                --compiler-runtime
                --force
                --dir "${CMAKE_CURRENT_BINARY_DIR}"
                # --dir "${CMAKE_CURRENT_BINARY_DIR}/deploy"
                $<TARGET_FILE:GZHHotkeysEditor>
        )
    endif()
endif()
#----------------------------------------------
